---
title: "Flow"
author: "Basil Eric Rabi"
date: "September 11, 2018"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Flow}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

# budget() Flow
```{dot, echo=FALSE}
digraph budget {

  node [shape = box]
    budget [label = "budget( xlsxFile, year, forecast )"]
    import_requirement [label = "read 'Requirement' sheet"]
    import_schedule [label = "read 'Schedule' sheet"]
    import_pool [label = "read 'Pool' sheet"]
    import_holiday [label = "read 'hol' sheet"]
    getmhDB [label =<
<TABLE BORDER="0">
  <TR><TD ALIGN="right">getmhDB&#40;</TD><TD ALIGN="left">Requirement</TD></TR>
  <TR><TD></TD><TD ALIGN="left">Pool</TD></TR>
  <TR><TD></TD><TD ALIGN="left">Schedule</TD></TR>
  <TR><TD></TD><TD ALIGN="left">year</TD></TR>
  <TR><TD></TD><TD ALIGN="left">hol &#41; -&gt;</TD></TR>
  <TR><TD>mhDB</TD><TD>listR</TD></TR>
  <TR><TD>mhReq</TD><TD>mhPool</TD>
  </TR>
</TABLE>>]
    import_wage [label = "read 'Wage' sheet"]
    getCost [label =<
<TABLE BORDER="0">
  <TR><TD ALIGN="right">geCost&#40;</TD><TD ALIGN="left">mhDB</TD></TR>
  <TR><TD></TD><TD ALIGN="left">listR</TD></TR>
  <TR><TD></TD><TD ALIGN="left">Wage</TD></TR>
  <TR><TD></TD><TD ALIGN="left">forecast &#41; -&gt;</TD></TR>
  <TR><TD ALIGN="right">costDB[</TD><TD ALIGN="left">Personnel Cost</TD></TR>
  <TR><TD></TD><TD ALIGN="left">Manhours</TD></TR>
  <TR><TD></TD><TD ALIGN="left">13<SUP>th</SUP> Month Pay</TD></TR>
  <TR><TD></TD><TD ALIGN="left">Bonus</TD></TR>
</TABLE>>]
    costs [label = "Write to xlsx: Personnel Cost Tables"]
    manhours [label = "Write to xlsx: Manhours Table"]
    mp13 [label = <Write 13<SUP>th</SUP> Month Pay Tables>]
    bonus [label = "Write Bonus Table"]
    excess [label ="Summarize excess manhours
using mhPool and Pool"]
    write_excess [label = "Write Excess Manhours Table"]
    lacking [label = "Summarize lacking manhours
using mhReq"]
    write_lacking [label = "Write Lacking Manhours Table"]
    
  node [shape = "box" style = "rounded"]
    end [label = "return
null"]

  budget -> import_requirement
  import_requirement -> import_schedule
  import_schedule-> import_pool
  import_pool -> import_holiday
  import_holiday -> getmhDB
  getmhDB -> import_wage
  import_wage -> getCost
  getCost -> costs
  costs -> manhours
  manhours -> mp13
  mp13 -> bonus
  bonus -> excess
  excess -> write_excess
  write_excess -> lacking
  lacking -> write_lacking
  write_lacking -> end
}
```

## getmhDB() Flow
```{dot, echo=FALSE}
digraph getmhDB {

node [shape = box]

  getmhDB [label = "getmhDB( empReq, empPool, sched, year, hol )"]
  g [label = "initialize employee pool"]
h [label = "initialize employee requirements"]
i [label = "separate pool and requirements by personnel class"]

j [label = "Staff"]
k [label = "Clerk"]
l [label = "Technical"]
m [label = "Supervisor"]
n [label = "Laborer"]
o [label = "Operator"]

p [label = "assignPrio()"]
q [label = "..."]
r [label = "..."]
s [label = "..."]
t [label = "..."]
u [label = "..."]

v [label = "assignPool(): select only matching costCode"]
w [label = "assignPool(): select only reg and pro"]
x [label = "assignPool(): select all available"]
y [label = "assign to dcc"]
z [label = "assign all remaining to '0-0' "]

aa [label = "..."]
ab [label = "..."]
ac [label = "..."]
ad [label = "..."]
ae [label = "..."]

af [label = "..."]
ag [label = "..."]
ah [label = "..."]
ai [label = "..."]
aj [label = "..."]

ak [label = "..."]
al [label = "..."]
am [label = "..."]
an [label = "..."]
ao [label = "..."]

ap [label = "..."]
aq [label = "..."]
ar [label = "..."]
as [label = "..."]
at [label = "..."]

au [label = "..."]
av [label = "..."]
aw [label = "..."]
ax [label = "..."]
ay [label = "..."]

az [label = "merge assigned man hours database"]
aaa [label = "import Wage"]
aab [label = "getCost()"]


g -> h -> i -> {j, k, l, m, n, o}

j -> p -> v  -> w  -> x  -> y  -> z
k -> q -> aa -> ab -> ac -> ad -> ae
l -> r -> af -> ag -> ah -> ai -> aj
m -> s -> ak -> al -> am -> an -> ao
n -> t -> ap -> aq -> ar -> as -> at
o -> u -> au -> av -> aw -> ax -> ay

{z, ae, aj, ao, at, ay} -> az -> aaa -> aab
}
```

## getCost() Flow

# assignPool() Flow
```{dot, echo=FALSE}
digraph assignPool {

node [shape = box]

  pA [label = "import list of Requirement"]
  pB [label = "import list of Employees"]
  pC [label = "i = 1"]
  pD [label = "empReq = Requirement[[i]]"]
  pE [label = "Employees <- Employees[with matching costCode]"]
  pF [label = "Employees <- Employees"]
  pG [label = "Employees <- Employees[with qualified status]"]
  pH [label = "Employees <- Employees"]
  pI [label = "assign Employees to empReq"]
  pJ [label = "return man-hours assignment"]
  pK [label = "i = i + 1"]
  
  
node [shape = diamond]

  dA [label = "Is costCode prioritized?"]
  dB [label = "Is there a prioritized Status?"]
  dC [label = "Is it the final Requirement?"]

pA -> pB -> pC -> pD -> dA
dA -> pE [label = "yes"]
dA -> pF [label = "no"]
{pE, pF} -> dB
dB -> pG [label = "yes"]
dB -> pH [label = "no"]
{pG, pH} -> pI -> dC
dC -> pJ [label = yes]
dC -> pK [label = no]
pK -> pD
}
```
